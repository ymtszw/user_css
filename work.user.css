/* ==UserStyle==
@name         My UserCSS at work
@description  My UserCSS at work
@namespace    ymtszw
@author       ymtszw (https://ymtszw.cc)
@homepageURL  https://github.com/ymtszw/user_css
@updateURL    https://raw.githubusercontent.com/ymtszw/user_css/main/work.user.css
@version      1.20240301.3
@license      Unlicensed
==/UserStyle== */

/*

  GitHub

*/
@-moz-document domain("github.com") {
  .blob-code-inner {
    font-family: Cica !important;
    font-size: 13px;
  }

  .markdown-body pre {
    font-family: Cica !important;
    line-height: 1.2 !important;
  }

  .markdown-body .highlight pre {
    font-size: 100% !important;
  }
}

/*

  Slack

*/
@-moz-document domain("app.slack.com") {
  .c-reaction {
    background-color: #ffffffc7;
  }
  .c-reaction__count {
    color: black;
  }
  .c-emoji__small {
    width: 22px;
    height: 22px;
  }
  [alt^=":dakoku"].c-emoji__small,
  [alt^=":memo_remote_ok"].c-emoji__small,
  [alt^=":switch_location_ok"].c-emoji__small {
    width: 16px;
    height: 16px;
  }
}

/*

  Trello

*/
@-moz-document domain("trello.com") {
  /* カード詳細のカスタム */
  @media screen and (min-width: 1280px) {
    [role="dialog"]:has(.card-detail-window) {
      width: 85vw;
    }
    .window-main-col {
      width: 60vw;
    }
    .window-sidebar {
      min-width: 220px;
      width: 20vw;
      max-width: 300px;
    }
  }

  /* Doneリスト */
  #board
    > :has(
      [data-testid="list-name-textarea"][aria-label*="Arc2" i],
      [data-testid="list-name-textarea"][aria-label*="Done" i],
      [data-testid="list-name-textarea"][aria-label*="完了" i]
    )
    > div {
    background-color: #a6a9b3;
  }
  #board
    > :has(
      [data-testid="list-name-textarea"][aria-label*="Arc2" i],
      [data-testid="list-name-textarea"][aria-label*="Done" i],
      [data-testid="list-name-textarea"][aria-label*="完了" i]
    )
    > div
    ol
    li
    div {
    background-color: #cfd3dd;
    overflow: hidden;
  }

  /* リストカウンター */
  ol#board > li {
    /*
      Trelloはボード→リスト→カードという層構造になっているので、ol#board直下のアイテム＝各Trelloリスト、ということになる。
      各Trelloリストごとにカウンターリセットし、子孫のol[data-testid="list-cards"] > liごとにインクリメントすればすなわちカード枚数カウントになる。
    */
    counter-reset: card-counter;
  }
  ol#board > li ol[data-testid="list-cards"] > li {
    counter-increment: card-counter;
  }
  ol#board > li::after {
    /*
      ol#board > liという各Trelloリストの「最大域」のafter疑似要素を使うことで、カウンター表示位置を最も柔軟に制御できる。
    */
    position: absolute;
    top: 0;
    content: counter(card-counter);
    background-color: #d7fe74;
    border-width: 1px;
    border-style: solid;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    font-size: 15px;
    line-height: 20px;
    text-align: center;
    transform: translate(-7px, 7px);
  }
}
